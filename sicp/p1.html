<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>第一章： 构造过程抽象 解题集</title>
<!-- 2015-07-17 五 11:25 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="BillyHuang@sina.cn" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../resources/style/style.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
            config: ["MMLorHTML.js"], jax: ["input/TeX"],
        //  jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "left",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">第一章： 构造过程抽象 解题集</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 练习 1.1</a></li>
<li><a href="#sec-2">2. 练习 1.2</a></li>
<li><a href="#sec-3">3. 练习 1.3</a></li>
<li><a href="#sec-4">4. 练习 1.4</a></li>
<li><a href="#sec-5">5. 练习 1.5</a></li>
<li><a href="#sec-6">6. 练习 1.6</a></li>
<li><a href="#sec-7">7. 练习 1.7</a></li>
<li><a href="#sec-8">8. 练习 1.8</a></li>
<li><a href="#sec-9">9. 练习 1.9</a></li>
<li><a href="#sec-10">10. 练习 1.10</a></li>
<li><a href="#sec-11">11. 练习 1.11</a></li>
<li><a href="#sec-12">12. 练习 1.12</a></li>
<li><a href="#sec-13">13. 练习 1.13</a></li>
<li><a href="#sec-14">14. 练习 1.14</a></li>
<li><a href="#sec-15">15. 练习 1.15</a></li>
<li><a href="#sec-16">16. 练习 1.16</a></li>
<li><a href="#sec-17">17. 练习 1.17 &amp; 1.18</a></li>
<li><a href="#sec-18">18. 练习 1.19</a></li>
<li><a href="#sec-19">19. 练习 1.20</a></li>
<li><a href="#sec-20">20. 练习 1.21</a></li>
<li><a href="#sec-21">21. 练习 1.22</a></li>
<li><a href="#sec-22">22. 练习 1.23</a></li>
<li><a href="#sec-23">23. 练习 1.24</a></li>
<li><a href="#sec-24">24. 练习 1.25</a></li>
<li><a href="#sec-25">25. 练习 1.26</a></li>
<li><a href="#sec-26">26. 练习 1.27</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 练习 1.1</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">

<pre class="src src-scheme">10
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 10</span>

(+ 5 3 4)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 12</span>

(- 9 1)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 8</span>

(/ 6 2)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 3</span>

(+ (* 2 4) (- 4 6))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 6</span>

(<span style="color: #859900;">define</span> <span style="color: #b58900;">a</span> 3)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: a</span>

(<span style="color: #859900;">define</span> <span style="color: #b58900;">b</span> (+ a 1))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: b</span>

(+ a b (* a b))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 19</span>

(= a b)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: #f</span>

(<span style="color: #859900;">if</span> (<span style="color: #859900;">and</span> (&gt; b a) (&lt; b (* a b)))
    b
    a)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 4</span>

(<span style="color: #859900;">cond</span> ((= a 4) 6)
      ((= b 4) (+ 6 7 a))
      (<span style="color: #859900;">else</span> 25))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 16</span>

(+ 2 (<span style="color: #859900;">if</span> (&gt; b a) b a))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 6</span>

(* (<span style="color: #859900;">cond</span> ((&gt; a b) a)
         ((&lt; a b) b)
         (<span style="color: #859900;">else</span> -1))
   (+ a 1))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer: 16</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 练习 1.2</h2>
<div class="outline-text-2" id="text-2">
<p>
$$\frac{5+4+(2-(3-(6+\frac{4}{5})))}{3*(6-2)*(2-7)}$$
</p>
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
(\ (+ 5 4 (- 2 (- 3 (+ 6 (\ 4 5))))) (* 3 (- 6 2) (- 7 2)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 练习 1.3</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">summax</span> a b c)
  (<span style="color: #859900;">cond</span> ((&gt; a b)
         (<span style="color: #859900;">cond</span> ((&gt; b c) (+ a b))
               (<span style="color: #859900;">else</span> (+ a c))))
        (<span style="color: #859900;">else</span> (<span style="color: #859900;">cond</span> ((&gt; a c) (+ b a))
                    (<span style="color: #859900;">else</span> (+ b c))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 练习 1.4</h2>
<div class="outline-text-2" id="text-4">
<p>
略
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> 练习 1.5</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">p</span>) (p))
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">test</span> x y)
  (<span style="color: #859900;">if</span> (= x 0)
      0
      y))

&#65288;test 0 (p)&#65289;

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#27491;&#21017;&#24207;&#27714;&#20540;&#36820;&#22238;0;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#24212;&#29992;&#24207;&#27714;&#20540;&#20250;&#20986;&#29616;&#26080;&#38480;&#36882;&#24402;&#35843;&#29992;&#12290;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> 练习 1.6</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">new-if</span> predicate then-clause else-clause)
  (<span style="color: #859900;">cond</span> (predicate then-clause)
        (<span style="color: #859900;">else</span> else-clause)))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">new-sqrt-iter</span> guess x)
  (new-if (good-enough? guess x)
          guess
          (new-sqrt-iter (improve guess x)
                         x)))

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#20250;&#20986;&#29616;&#26080;&#38480;&#36882;&#24402;&#35843;&#29992;&#12290;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#21407;&#22240;&#26159;&#65306;&#25353;&#29031;&#24212;&#29992;&#24207;&#27714;&#20540;&#65292;&#27599;&#20010;&#21442;&#25968;&#37117;&#20250;&#20808;&#36827;&#34892;&#27714;&#20540;&#12290;&#25152;&#20197;&#19981;&#31649;&#26159;true&#65292;&#36824;&#26159;false else-clause&#37117;&#20250;&#34987;&#25191;&#34892;&#12290;&#36827;&#32780;&#23548;&#33268;&#26080;&#38480;&#36882;&#24402;&#12290;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#32780;if&#20026;&#29305;&#27530;&#30340;&#36807;&#31243;then-clause&#21644;else-clause&#21482;&#20250;&#25191;&#34892;&#19968;&#20010;&#12290;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#39564;&#35777;&#30340;&#34920;&#36798;&#24335;&#65306;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(new-if #t (list 0 (display "true")) (display "false"))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#36820;&#22238;&#32467;&#26524;&#20026;&#65306;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(new-if): truefalse(0 #&lt;void&gt;)</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(if): true(0 #&lt;void&gt;)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> 练习 1.7</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">new-good-enough?</span> new-guess old-guess)
  (&lt; (abs (- new-guess old-guess)) 0.00000001))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> 练习 1.8</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">cube-iter</span> guess x)
  (<span style="color: #859900;">if</span> (cube-good-enough? guess x)
      guess
      (cube-iter (improve-cube guess x) x)))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">improve-cube</span> guess x)
  (/ (+ (/ x (square guess)) (* 2 guess)) 3))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">cube-good-enough?</span> guess x)
  (&lt; (abs (- (* guess guess guess) x)) 0.0001))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">cube</span> x)
  (cube-iter 1.0 x))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> 练习 1.9</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#26041;&#27861;&#19968;&#20026;&#32447;&#24615;&#36882;&#24402;&#35745;&#31639;&#36807;&#31243;&#65292;&#23637;&#24320;&#24335;&#22914;&#19979;&#65306;</span>
&#65288;+ 4 5&#65289;
(inc (+ 3 5))
(inc (inc (+ 2 5)))
(inc (inc (inc (+ 1 5))))
(inc (inc (inc (inc (+ 0 5)))))
(inc (inc (inc (inc 5))))
(inc (inc (inc 6)))
(inc (inc 7))
(inc 8)
9

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#26041;&#27861;&#20108;&#20026;&#36882;&#24402;&#36845;&#20195;&#35745;&#31639;&#36807;&#31243;&#65292;&#23637;&#24320;&#24335;&#22914;&#19979;&#65306;</span>
&#65288;+ 4 5&#65289;
&#65288;+ 3 6&#65289;
&#65288;+ 2 7&#65289;
&#65288;+ 1 8&#65289;
&#65288;+ 0 9&#65289;
9
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> 练习 1.10</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">A</span> x y)
  (<span style="color: #859900;">cond</span> ((= y 0) 0)
        ((= x 0) (* 2 y))
        ((= y 1) 2)
        (<span style="color: #859900;">else</span> (A (- x 1)
                 (A (- y 1))))))

(A 1 10)
(A 2 4)
(A 3 3)
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">f</span> n) (A 0 n))
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">g</span> n) (A 1 n))
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">h</span> n) (A 2 n))
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">k</span> n) (* 5 n n))
</pre>
</div>
<ul class="org-ul">
<li>answer:
<ul class="org-ul">
<li>2<sup>10</sup>
</li>
<li>2<sup>16</sup>
</li>
<li>2<sup>16</sup>
</li>
<li>f(n)=2n
</li>
<li>g(n)=2<sup>n</sup>
</li>
<li>h(n)=2<sup>2n</sup>
</li>
<li>k(n)=5n<sup>2</sup>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> 练习 1.11</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#36882;&#24402;&#35745;&#31639;&#36807;&#31243;&#23454;&#29616;</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">f</span> n)
  (<span style="color: #859900;">cond</span> ((&lt; n 3) n)
        (<span style="color: #859900;">else</span> (+ (f (- n 1))
                 (* 2 (f (- n 2)))
                 (* 3 (f (- n 3)))))))

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#36845;&#20195;&#35745;&#31639;&#36807;&#31243;&#23454;&#29616;</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">f-iter</span> n)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">iter</span> a b c count)
    (<span style="color: #859900;">cond</span> ((= count 0) a)
          (<span style="color: #859900;">else</span> (iter b c (+ (* 3 a) (* 2 b) c) (- count 1)))))
  (iter 0 1 2 n))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> 练习 1.12</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#36882;&#24402;&#35745;&#31639;&#36807;&#31243;&#23454;&#29616;</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">pascal</span> row col)
  (<span style="color: #859900;">cond</span> ((&gt; col row) (error <span style="color: #2aa198;">"illegal col value!"</span>))
        ((<span style="color: #859900;">or</span> (= col 0) (= row col)) 1)
        (<span style="color: #859900;">else</span> (+ (pascal (- row 1) (- col 1))
                 (pascal (- row 1) col)))))

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#36845;&#20195;&#35745;&#31639;&#36807;&#31243;&#23454;&#29616;</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">pascal-iter</span> row col)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">factorial-iter</span> value counter n)
    (<span style="color: #859900;">cond</span> ((= counter n) value)
          (<span style="color: #859900;">else</span> (factorial-iter (* value (+ counter 1))
                                (+ counter 1)
                                n))))
  (<span style="color: #859900;">cond</span> ((&gt; col row)
         (error <span style="color: #2aa198;">"illegal col value!"</span>))
        ((<span style="color: #859900;">or</span> (= col 0) (= row col)) 1)
        (<span style="color: #859900;">else</span>
         (/ (factorial-iter 1 1 row)
            (* (factorial-iter 1 1 col)
               (factorial-iter 1 1 (- row col)))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13"><span class="section-number-2">13</span> 练习 1.13</h2>
<div class="outline-text-2" id="text-13">
<p>
略
</p>
</div>
</div>

<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14"><span class="section-number-2">14</span> 练习 1.14</h2>
<div class="outline-text-2" id="text-14">

<div class="figure">
<p><img src="../resources/svg/1.14.svg" alt="1.14.svg" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15"><span class="section-number-2">15</span> 练习 1.15</h2>
<div class="outline-text-2" id="text-15">
<p>
\(sinx=3sin\frac{x}{3}-4sin^3\frac{x}{3}\)
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">cube</span> x) (* x x x))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">p</span> x) (- (* 3 x) (* 4 (cube x))))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">sine</span> angle)
  (<span style="color: #859900;">if</span> (&lt; (abs angle) 0.1)
      angle
      (p (sine (/ angle 3.0)))))
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">a)</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(sine 12.15)</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(p (sine 4.5))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(p (p (sine 1.5)))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(p (p (p (sine 0.5))))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(p (p (p (p (sine 0.166666)))))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">(p (p (p (p (p (p (sine 0.0555555)))))))</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">p&#34987;&#25191;&#34892;&#20102;6&#27425;&#65307;</span>

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">b)</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#920;(n)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-16" class="outline-2">
<h2 id="sec-16"><span class="section-number-2">16</span> 练习 1.16</h2>
<div class="outline-text-2" id="text-16">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">answer:</span>
(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fast-expt-iter</span> b n)
  (<span style="color: #859900;">cond</span> ((= n 0) 1)
        ((even? n)
         (fast-expt-iter (square b) (/ n 2)))
        (<span style="color: #859900;">else</span> (* b (fast-expt-iter b (- n 1))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-17" class="outline-2">
<h2 id="sec-17"><span class="section-number-2">17</span> 练习 1.17 &amp; 1.18</h2>
<div class="outline-text-2" id="text-17">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">double</span> a)
  (+ a a))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">halve</span> a)
  (/ a 2))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fast-*</span> a b)
  (<span style="color: #859900;">cond</span> ((<span style="color: #859900;">or</span> (= b 0) (= a 0)) 0)
        ((even? b)
         (fast-* (double a) (halve b)))
        (<span style="color: #859900;">else</span> (+ a (fast-* a (- b 1))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-18" class="outline-2">
<h2 id="sec-18"><span class="section-number-2">18</span> 练习 1.19</h2>
<div class="outline-text-2" id="text-18">
<p>
Fib矩阵公式：
$$\begin{pmatrix}fib(n)\\fib(n+1)\end{pmatrix}=\begin{pmatrix}0&1\\1&1\end{pmatrix}^n\begin{pmatrix}0\\1\end{pmatrix}$$
变换说明：
$$\begin{pmatrix}p&q\\q&p+q\end{pmatrix}\begin{pmatrix}a\\b\end{pmatrix}=\begin{pmatrix}ap+bq\\aq+bp+bq\end{pmatrix}=>\begin{cases}a&\leftarrow\ bq+ap+aq, \\ b&\leftarrow\ bp+aq. \end{cases}$$
</p>
<ul class="org-ul">
<li><b>answer:</b>
<ul class="org-ul">
<li>证明：
</li>
</ul>
</li>
</ul>
<p>
$$\begin{pmatrix}p&q\\q&p+q\end{pmatrix}\begin{pmatrix}p&q\\q&p+q\end{pmatrix}=\begin{pmatrix}p^2+q^2&2pq+q^2\\2pq+q^2&p^2+2q^2+2pq\end{pmatrix}$$
所以：p'=p<sup>2</sup>+q<sup>2</sup>; q'=2ab+b<sup>2</sup>,证毕。
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fib</span> n)
  (fib-iter 1 0 0 1 n))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fib-iter</span> a b p q count)
  (<span style="color: #859900;">cond</span> ((= 0 count) b)
        ((even? count)
         (fib-iter a
                   b
                   (+ (square p) (square q))
                   (+ (* 2 p q) (square q))
                   (/ count 2)))
        (<span style="color: #859900;">else</span> (fib-iter (+ (* b q) (* a q) (* a p))
                        (+ (* b p) (* a q))
                        p
                        q
                        (- count 1)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-19" class="outline-2">
<h2 id="sec-19"><span class="section-number-2">19</span> 练习 1.20</h2>
<div class="outline-text-2" id="text-19">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#27491;&#21017;&#24207;</span>
(gcd 206 40)
(gcd 40 (remainder 206 40))
(gcd (remainder 206 40) (remainder 40 (remainder 206 40)))
(gcd (remainder 40 (remainder 206 40)) (remiander (remainder 206 40) (remainder 40 (remainder 206 40))))
(gcd (remiander (remainder 206 40) (remainder 40 (remainder 206 40))) ((remainder 40 (remainder 206 40)) (remiander (remainder 206 40) (remainder 40 (remainder 206 40)))))

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#24212;&#29992;&#24207;</span>
(gcd 206 40)
(gcd 40 (remainder 206 40))
(gcd 40 6)
(gcd 6 (remainder 40 6))
(gcd 6 4)
(gcd 4 (remainder 6 4))
(gcd 4 2)
(gcd 2 (remainder 4 2))
(gcd 2 0)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-20" class="outline-2">
<h2 id="sec-20"><span class="section-number-2">20</span> 练习 1.21</h2>
<div class="outline-text-2" id="text-20">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">smallest-divisor</span> n)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">find-divisor</span> n test-divisor)
    (<span style="color: #859900;">cond</span> ((&gt; (square test-divisor) n) n)
          ((divides? test-divisor n) test-divisor)
          (<span style="color: #859900;">else</span> (find-divisor n (+ test-divisor 1)))))
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">divides?</span> a b)
    (= (remainder b a) 0))
  (find-divisor n 2))

(smallest-divisor 199)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">199</span>
(smallest-divisor 1999)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">1999</span>
(smallest-divisor 19999)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">7</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-21" class="outline-2">
<h2 id="sec-21"><span class="section-number-2">21</span> 练习 1.22</h2>
<div class="outline-text-2" id="text-21">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">time-prime-test</span> n)
  (start-prime-time n (real-time-clock)))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">start-prime-time</span> n start-time)
  (<span style="color: #859900;">cond</span> ((prime? n)
         (newline) (display n) (report-prime (- (real-time-clock) start-time)))))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">report-prime</span> elapsed-time)
  (display <span style="color: #2aa198;">" *** "</span>)
  (display elapsed-time))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">search-for-primes</span> min max)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">iter</span> n min max)
    (<span style="color: #859900;">cond</span> ((<span style="color: #859900;">or</span> (&lt; n min) (&gt; n max)) n (newline) (display <span style="color: #2aa198;">"end."</span>))
          ((even? n) (iter (+ n 1) min max))
          (<span style="color: #859900;">else</span> (time-prime-test n) (iter (+ n 2) min max))))
  (iter min min max))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-22" class="outline-2">
<h2 id="sec-22"><span class="section-number-2">22</span> 练习 1.23</h2>
<div class="outline-text-2" id="text-22">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">smallest-divisor</span> n)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">find-divisor</span> n test-divisor)
    (<span style="color: #859900;">cond</span> ((&gt; (square test-divisor) n) n)
          ((divides? test-divisor n) test-divisor)
          (<span style="color: #859900;">else</span> (find-divisor n (+ 1 test-divisor)))))
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">divides?</span> a b)
    (= (remainder b a) 0))
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">next</span> n)
    (<span style="color: #859900;">cond</span> ((even? n) (+ n 1))
          (<span style="color: #859900;">else</span> (+ n 2))))
  (find-divisor n 2))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-23" class="outline-2">
<h2 id="sec-23"><span class="section-number-2">23</span> 练习 1.24</h2>
<div class="outline-text-2" id="text-23">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">expmod</span> base exp m)
  (<span style="color: #859900;">cond</span> ((= exp 0) 1)
        ((even? exp)
         (remainder (square (expmod base (/ exp 2)))
                    m))
        (<span style="color: #859900;">else</span> (remainder (* base (expmod base (- exp 1) m))
                         m))))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fermat-test</span> n)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">try-it</span> a)
    (= (expmod a n n) a))
  (try-it (+ 1 (random (- n 1)))))

(<span style="color: #859900;">define</span> (<span style="color: #b58900;">fast-prime?</span> n times)
  (<span style="color: #859900;">cond</span> ((= times 0) true)
        ((fermat-test n) (fast-prime? n (- times 1)))
        (<span style="color: #859900;">else</span> false)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-24" class="outline-2">
<h2 id="sec-24"><span class="section-number-2">24</span> 练习 1.25</h2>
<div class="outline-text-2" id="text-24">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">expmod-bad</span> base exp m)
  (remainder (fast-expt base exp) m))

<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">Alyssa &#30340; expmod-bad &#20989;&#25968;&#20174;&#29702;&#35770;&#19978;&#35828;&#27809;&#26377;&#20219;&#20309;&#38382;&#39064;&#65292;&#26159;&#21487;&#34892;&#30340;&#12290;&#20294;&#26159;&#22312;&#23454;&#38469;&#24212;&#29992;&#20013;&#26377;&#33268;&#21629;&#30340;&#32570;&#38519;&#12290;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">&#24403;&#35745;&#31639;&#19968;&#20010;&#24456;&#22823;&#30340;&#32032;&#25968;&#26159;&#65292;&#38656;&#35201;&#35745;&#31639;&#19968;&#20010;&#38750;&#24120;&#22823;&#30340;&#20056;&#24130;&#12290;&#32780;&#36825;&#20250;&#23548;&#33268;&#35745;&#31639;&#36895;&#24230;&#38750;&#24120;&#24930;&#65292;&#32780;&#19988;&#21487;&#33021;&#20250;&#23548;&#33268;&#28322;&#20986;&#12290;</span>
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">expmod &#20989;&#25968;&#65292;&#36890;&#36807;&#27599;&#27425;&#23545;&#20056;&#24130;&#36827;&#34892; remainder &#25805;&#20316;&#65292;&#20174;&#32780;&#23558;&#20056;&#24130;&#38480;&#21046;&#22312;&#19968;&#20010;&#24456;&#23567;&#30340;&#33539;&#22260;&#20869;&#65288;&#19981;&#36229;&#36807;&#21442;&#25968; m &#65289;&#65292;&#36825;&#26679;&#21487;&#20197;&#26368;&#22823;&#38480;&#24230;&#22320;&#36991;&#20813;&#28322;&#20986;&#65292;&#32780;&#19988;&#35745;&#31639;&#36895;&#24230;&#24555;&#24471;&#22810;&#12290;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-25" class="outline-2">
<h2 id="sec-25"><span class="section-number-2">25</span> 练习 1.26</h2>
<div class="outline-text-2" id="text-25">
<p>
+answer： 使用乘法而未使用 square 函数，使得 expmod 函数原来的线性递归变成了两个分支的树形递归，计算量是原来expmod复杂度的平方，即Θ(logn)的平方，即Θ(n)。
</p>
</div>
</div>

<div id="outline-container-sec-26" class="outline-2">
<h2 id="sec-26"><span class="section-number-2">26</span> 练习 1.27</h2>
<div class="outline-text-2" id="text-26">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #859900;">define</span> (<span style="color: #b58900;">carmichael-test</span> n)
  (<span style="color: #859900;">define</span> (<span style="color: #b58900;">test</span> a n)
    (<span style="color: #859900;">cond</span> ((= a n) true)
          ((= (expmod a n n) a)
           (test (+ a 1) n))
          (<span style="color: #859900;">else</span> false)))
  (test 1 n))

(carmichael-test 561)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">#t</span>
(carmichael-test 1105)
<span style="color: #93a1a1; font-style: italic;">;; </span><span style="color: #93a1a1; font-style: italic;">#t</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: BillyHuang@sina.cn</p>
<p class="date">Created: 2015-07-17 五 11:25</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
